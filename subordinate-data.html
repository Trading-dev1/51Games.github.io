<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Subordinate Data</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=arrow_forward_ios,expand_more" />
    <style>
        body {
            background: #f5f6fa;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 0;
        }
        .header {
            background: #fff;
            padding: 16px 0;
            text-align: center;
            font-size: 20px;
            font-weight: 500;
            position: relative;
            border-bottom: 1px solid #eee;
        }
        .header .back {
            position: absolute;
            left: 16px;
            top: 16px;
            font-size: 22px;
            color: #333;
            text-decoration: none;
        }
        .search-bar {
            display: flex;
            align-items: center;
            background: #fff;
            margin: 10px 12px 8px 12px;
            border-radius: 8px;
            padding: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.03);
        }
        .search-bar input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 13px;
            background: transparent;
            padding: 8px;
        }
        .search-bar button {
            background: #ffcb2d;
            border: none;
            color: #fff;
            border-radius: 30%;
            width: 38px;
            height: 28px;
            font-size: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .filters {
            display: flex;
            gap: 8px;
            margin: 0 12px 10px 12px;
        }
        .filters select {
            flex: 1;
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #eee;
            background: #fff;
            font-size: 12px;
        }
        .stats-box {
            background: #ffcb2d;
            color: #fff;
            border-radius: 12px;
            margin: 0 12px 16px 12px;
            padding: 20px 4px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-row-gap: 16px;
            grid-column-gap: 0;
            font-size: 11.5px;
            min-height: 160px;
        }
        .stats-box .stat {
            text-align: center;
        }
        .stats-box .stat .value {
            font-size: 13px;
            font-weight: bold;
        }
        .stats-box .stat .value.deposit-number {
            color: #fff !important;
        }
        .stats-box .stat .value.deposit-amount {
            color: #fff !important;
        }
        .stats-col .time-value {
            color: #666;  /* Grey color */
            font-size: 12px;  /* Smaller size */
            font-weight: normal;
        }
        .no-data {
            text-align: center;
            color: #bbb;
            margin-top: 32px;
            font-size: 13px;
        }
        .no-data-img {
            display: none;
        }
        .no-data-icon {
            display: none;
        }
        .date-modal-overlay {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0; top: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.18);
            justify-content: center;
            align-items: flex-end;
        }
        .date-modal-overlay.active {
            display: flex;
        }
        .date-modal {
            width: 100vw;
            max-width: 500px;
            background: #fff;
            border-radius: 18px 18px 0 0;
            padding: 0 0 10px 0;
            position: relative;
            min-height: 370px;
        }
        .date-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 18px 10px 18px;
            font-size: 17px;
            font-weight: 500;
        }
        .date-modal-header .cancel {
            color: #888;
            font-size: 16px;
            cursor: pointer;
            font-weight: 400;
        }
        .date-modal-header .confirm {
            color: #ffcb2d;
            font-size: 16px;
            cursor: pointer;
            font-weight: 400;
        }
        .date-modal-header .title {
            color: #111a3a;
            font-size: 18px;
            font-weight: bold;
            flex: 1;
            text-align: center;
            letter-spacing: 0.5px;
        }
        .date-picker-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 0 10px 0;
            margin: 0 10px;
            position: relative;
            height: 260px;
        }
        .picker-col {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: scroll;
            height: 220px;
            scrollbar-width: none;
            -ms-overflow-style: none;
            position: relative;
        }
        .picker-col::-webkit-scrollbar {
            display: none;
        }
        .picker-item {
            font-size: 20px;
            color: #b0b0b0;
            padding: 7px 0;
            text-align: center;
            min-height: 32px;
            transition: color 0.15s, font-weight 0.15s;
            font-weight: 400;
            user-select: none;
        }
        .picker-item.selected {
            color: #222;
            font-weight: bold;
            font-size: 22px;
            background: #f7f7f7;
            border-radius: 8px;
        }
        .picker-col:not(:last-child) {
            border-right: 1px solid #f2f2f2;
        }
        .picker-highlight {
            position: absolute;
            left: 0; right: 0;
            top: 50%;
            transform: translateY(-50%);
            height: 32px;
            background: rgba(0,0,0,0.03);
            border-radius: 8px;
            pointer-events: none;
            z-index: 2;
        }
        .loading-spinner {
            display: none;
            margin: 12px auto 0 auto;
            width: 22px;
            height: 22px;
            border: 3px solid #e0e0e0;
            border-top: 3px solid #bdbdbd;
            border-radius: 50%;
            animation: spin 0.7s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(360deg);}
        }
        .tier-option.selected {
            color: #222 !important;
            font-weight: bold !important;
            background: #f7f7f7;
            border-radius: 8px;
        }
        .tier-option {
            cursor: pointer;
            transition: background 0.15s, color 0.15s;
            font-size: 18px;
            padding: 12px 0;
            width: 100%;
            text-align: center;
            color: #b0b0b0;
            user-select: none;
        }
        .tier-picker-col::-webkit-scrollbar {
            display: none;
        }
        * {
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        button, 
        input,
        select,
        .picker-item,
        .tier-option {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="index.html" class="back"><span class='material-symbols-outlined' style='font-size:18px;transform:rotate(180deg);vertical-align:middle;'>arrow_forward_ios</span></a>
        Subordinate data
    </div>
    <div class="search-bar">
        <input type="text" placeholder="Search subordinate UID">
        <button aria-label="Search">
            <svg width="15" height="15" viewBox="0 0 20 20" fill="white" xmlns="http://www.w3.org/2000/svg">
                <circle cx="9" cy="9" r="7" stroke="white" stroke-width="2" fill="none"/>
                <line x1="14" y1="14" x2="19" y2="19" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
        </button>
    </div>
    <div class="filters">
        <div id="tierSelectBtn" style="flex:1;position:relative;">
            <button id="openTierModal" style="width:100%;padding:8px 0;border-radius:6px;border:1px solid #eee;background:#fff;font-size:12px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;">
                <span id="selectedTier">All</span>
                <span class="material-symbols-outlined" style="font-size:18px;vertical-align:middle;">expand_more</span>
            </button>
        </div>
        <div id="date-select" style="flex:1;position:relative;">
            <button id="openDateModal" style="width:100%;padding:8px 0;border-radius:6px;border:1px solid #eee;background:#fff;font-size:12px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;">
                <span id="selectedDate">2025-05-17</span>
                <span class="material-symbols-outlined" style="font-size:18px;vertical-align:middle;">expand_more</span>
            </button>
        </div>
    </div>
    <div class="stats-box" id="statsBox">
        <div class="stat">
            <div class="value deposit-number" id="depositNumber">0</div>
            <div>Deposit number</div>
        </div>
        <div class="stat">
            <div class="value deposit-amount" id="depositAmount">0</div>
            <div>Deposit amount</div>
        </div>
        <div class="stat">
            <div class="value" id="numBettors">0</div>
            <div>Number of bettors</div>
        </div>
        <div class="stat">
            <div class="value" id="totalBet">0</div>
            <div>Total bet</div>
        </div>
        <div class="stat">
            <div class="value" id="numFirstDeposit">0</div>
            <div>Number of people making first deposit</div>
        </div>
        <div class="stat">
            <div class="value" id="firstDepositAmount">0</div>
            <div>First deposit amount</div>
        </div>
    </div>
    <div id="uidCards">
        <!-- UID cards will be dynamically inserted here -->
    </div>
    <div class="loading-spinner" id="loadingSpinner"></div>
    <div class="no-data" id="noData">
        Yesterday's commission
    </div>

    <!-- Date Picker Modal -->
    <div class="date-modal-overlay" id="dateModalOverlay">
        <div class="date-modal">
            <div class="date-modal-header">
                <span class="cancel" id="cancelDate">Cancel</span>
                <span class="title">Choose a date</span>
                <span class="confirm" id="confirmDate">Confirm</span>
            </div>
            <div class="date-picker-row">
                <div class="picker-col" id="yearCol"></div>
                <div class="picker-col" id="monthCol"></div>
                <div class="picker-col" id="dayCol"></div>
                <div class="picker-highlight"></div>
            </div>
        </div>
    </div>

    <!-- Tier Modal (visual only, now scrollable) -->
    <div class="date-modal-overlay" id="tierModalOverlay">
        <div class="date-modal" style="min-height: 270px; max-width: 350px;">
            <div class="date-modal-header">
                <span class="cancel" id="cancelTier" style="color:#888;cursor:pointer;">Cancel</span>
                <span class="title" style="color:#111a3a;font-size:18px;font-weight:bold;flex:1;text-align:center;">Choose Tier</span>
                <span class="confirm" id="confirmTier" style="color:#ffcb2d;cursor:pointer;">Confirm</span>
            </div>
            <div class="tier-picker-row" style="position:relative;height:180px;margin:0 10px;">
                <div class="tier-picker-col" id="tierCol" style="flex:1;display:flex;flex-direction:column;align-items:center;overflow-y:scroll;height:180px;scrollbar-width:none;-ms-overflow-style:none;position:relative;">
                    <!-- Options will be filled by JS -->
                </div>
                <div class="picker-highlight"></div>
            </div>
        </div>
    </div>
    <script>
        // --- Date Picker Logic ---
        let pickerState = { year: 2025, month: 5, day: 17 };

        const openDateModal = document.getElementById('openDateModal');
        const dateModalOverlay = document.getElementById('dateModalOverlay');
        const cancelDate = document.getElementById('cancelDate');
        const confirmDate = document.getElementById('confirmDate');
        const selectedDateSpan = document.getElementById('selectedDate');
        const yearCol = document.getElementById('yearCol');
        const monthCol = document.getElementById('monthCol');
        const dayCol = document.getElementById('dayCol');

        // Data for specific dates
        const statsData = {
            "2025-05-17": {
                "All": {
                    depositNumber: 327,
                    depositAmount: 340160,
                    numBettors: 305,
                    totalBet: 952146.53,
                    numFirstDeposit: 324,
                    firstDepositAmount: 286310
                },
                "Tier 1": {
                    depositNumber: 126,
                    depositAmount: 153810,
                    numBettors: 124,
                    totalBet: 318540.25,
                    numFirstDeposit: 124,
                    firstDepositAmount: 125830
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 2000, betAmount: 8185, commission: 22.67, time: "2025-05-17" },
                    { uid: "379529", level: 1, depositAmount: 306, betAmount: 725, commission: 9.18, time: "2025-05-17" },
                    { uid: "371693", level: 1, depositAmount: 1900, betAmount: 3268, commission: 29.18, time: "2025-05-17" },
                    { uid: "379351", level: 1, depositAmount: 300, betAmount: 327, commission: 7.81, time: "2025-05-17" },
                    { uid: "374529", level: 1, depositAmount: 13000, betAmount: 27839, commission: 31.62, time: "2025-05-17" },
                    { uid: "374193", level: 2, depositAmount: 4183, betAmount: 7538, commission: 19.81, time: "2025-05-17" },
                    { uid: "375942", level: 2, depositAmount: 2700, betAmount: 3186, commission: 19.83, time: "2025-05-17" },
                    { uid: "369361", level: 2, depositAmount: 1350, betAmount: 1648, commission: 11.73, time: "2025-05-17" }
                ]
            },
            "2025-05-16": {
                "All": {
                    depositNumber: 462,
                    depositAmount: 436170,
                    numBettors: 426,
                    totalBet: 937136.93,
                    numFirstDeposit: 404,
                    firstDepositAmount: 384735
                },
                "Tier 1": {
                    depositNumber: 156,
                    depositAmount: 263207,
                    numBettors: 143,
                    totalBet: 472850.36,
                    numFirstDeposit: 148,
                    firstDepositAmount: 216384
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 1000, betAmount: 1733, commission: 13.79, time: "2025-05-15" },
                    { uid: "379529", level: 1, depositAmount: 3100, betAmount: 4730, commission: 29.45, time: "2025-05-15" },
                    { uid: "371693", level: 1, depositAmount: 1767, betAmount: 2895, commission: 24.73, time: "2025-05-15" },
                    { uid: "379351", level: 1, depositAmount: 7400, betAmount: 12637, commission: 28.93, time: "2025-05-15" },
                    { uid: "374529", level: 1, depositAmount: 10440, betAmount: 31648, commission: 26.72, time: "2025-05-15" },
                    { uid: "374193", level: 2, depositAmount: 2500, betAmount: 4728, commission: 21.35, time: "2025-05-15" },
                    { uid: "375942", level: 2, depositAmount: 423, betAmount: 736, commission: 10.36, time: "2025-05-15" },
                    { uid: "369361", level: 2, depositAmount: 1375, betAmount: 2136, commission: 14.89, time: "2025-05-15" }
                ]
            },
            "2025-05-14": {
                "All": {
                    depositNumber: 541,
                    depositAmount: 568770,
                    numBettors: 528,
                    totalBet: 1254743.68,
                    numFirstDeposit: 505,
                    firstDepositAmount: 527430
                },
                "Tier 1": {
                    depositNumber: 184,
                    depositAmount: 195830,
                    numBettors: 182,
                    totalBet: 325864.73,
                    numFirstDeposit: 179,
                    firstDepositAmount: 173564
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 2704, betAmount: 3196, commission: 11.63, time: "2025-05-14" },
                    { uid: "379529", level: 1, depositAmount: 2700, betAmount: 3826, commission: 28.26, time: "2025-05-14" },
                    { uid: "371693", level: 1, depositAmount: 9600, betAmount: 18630, commission: 25.63, time: "2025-05-14" },
                    { uid: "379351", level: 1, depositAmount: 13000, betAmount: 25974, commission: 24.72, time: "2025-05-14" },
                    { uid: "374529", level: 1, depositAmount: 11070, betAmount: 19337, commission: 31.38, time: "2025-05-14" },
                    { uid: "374193", level: 2, depositAmount: 2200, betAmount: 3742, commission: 19.73, time: "2025-05-14" },
                    { uid: "375942", level: 2, depositAmount: 550, betAmount: 859, commission: 8.28, time: "2025-05-14" },
                    { uid: "369361", level: 2, depositAmount: 1429, betAmount: 1963, commission: 11.36, time: "2025-05-14" }
                ]
            },
            "2025-05-13": {
                "All": {
                    depositNumber: 420,
                    depositAmount: 763754,
                    numBettors: 402,
                    totalBet: 1786635.42,
                    numFirstDeposit: 401,
                    firstDepositAmount: 682149
                },
                "Tier 1": {
                    depositNumber: 153,
                    depositAmount: 225460,
                    numBettors: 142,
                    totalBet: 439625.27,
                    numFirstDeposit: 148,
                    firstDepositAmount: 197420
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 2510, betAmount: 2894, commission: 14.89, time: "2025-05-13" },
                    { uid: "379529", level: 1, depositAmount: 2600, betAmount: 3284, commission: 22.17, time: "2025-05-13" },
                    { uid: "371693", level: 1, depositAmount: 17000, betAmount: 32647, commission: 54.27, time: "2025-05-13" },
                    { uid: "379351", level: 1, depositAmount: 1000, betAmount: 1684, commission: 15.29, time: "2025-05-13" },
                    { uid: "374529", level: 1, depositAmount: 5200, betAmount: 9271, commission: 36.45, time: "2025-05-13" },
                    { uid: "374193", level: 2, depositAmount: 2100, betAmount: 4285, commission: 21.57, time: "2025-05-13" },
                    { uid: "375942", level: 2, depositAmount: 542, betAmount: 694, commission: 9.27, time: "2025-05-13" },
                    { uid: "369361", level: 2, depositAmount: 1356, betAmount: 1748, commission: 12.35, time: "2025-05-13" }
                ]
            },
            "2025-05-12": {
                "All": {
                    depositNumber: 396,
                    depositAmount: 362860,
                    numBettors: 375,
                    totalBet: 952468.13,
                    numFirstDeposit: 368,
                    firstDepositAmount: 296545
                },
                "Tier 1": {
                    depositNumber: 133,
                    depositAmount: 153250,
                    numBettors: 119,
                    totalBet: 281795.72,
                    numFirstDeposit: 113,
                    firstDepositAmount: 128430
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 2793, betAmount: 5328, commission: 26.19, time: "2025-05-12" },
                    { uid: "379529", level: 1, depositAmount: 5190, betAmount: 9256, commission: 42.61, time: "2025-05-12" },
                    { uid: "371693", level: 1, depositAmount: 12864, betAmount: 32864, commission: 56.72, time: "2025-05-12" },
                    { uid: "379351", level: 1, depositAmount: 1455, betAmount: 2641, commission: 13.97, time: "2025-05-12" },
                    { uid: "374529", level: 1, depositAmount: 5678, betAmount: 7964, commission: 31.64, time: "2025-05-12" },
                    { uid: "374193", level: 2, depositAmount: 2250, betAmount: 2682, commission: 22.30, time: "2025-05-12" },
                    { uid: "375942", level: 2, depositAmount: 574, betAmount: 963, commission: 13.51, time: "2025-05-12" },
                    { uid: "369361", level: 2, depositAmount: 1750, betAmount: 3295, commission: 19.44, time: "2025-05-12" }
                ]
            },
            "2025-05-11": {
                "All": {
                    depositNumber: 438,
                    depositAmount: 752950,
                    numBettors: 418,
                    totalBet: 1864380.72,
                    numFirstDeposit: 398,
                    firstDepositAmount: 652940
                },
                "Tier 1": {
                    depositNumber: 197,
                    depositAmount: 286440,
                    numBettors: 189,
                    totalBet: 885240.53,
                    numFirstDeposit: 182,
                    firstDepositAmount: 236855
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 2900, betAmount: 4582, commission: 31.74, time: "2025-05-11" },
                    { uid: "379529", level: 1, depositAmount: 2500, betAmount: 2964, commission: 41.36, time: "2025-05-11" },
                    { uid: "371693", level: 1, depositAmount: 14500, betAmount: 19460, commission: 69.53, time: "2025-05-11" },
                    { uid: "379351", level: 1, depositAmount: 600, betAmount: 953, commission: 17.53, time: "2025-05-11" },
                    { uid: "374529", level: 1, depositAmount: 5000, betAmount: 8520, commission: 38.26, time: "2025-05-11" },
                    { uid: "374193", level: 2, depositAmount: 1800, betAmount: 2930, commission: 25.64, time: "2025-05-11" },
                    { uid: "375942", level: 2, depositAmount: 620, betAmount: 786, commission: 16.29, time: "2025-05-11" },
                    { uid: "369361", level: 2, depositAmount: 1293, betAmount: 2784, commission: 17.35, time: "2025-05-11" }
                ]
            },
            "2025-05-10": {
                "All": {
                    depositNumber: 438,
                    depositAmount: 752950,
                    numBettors: 418,
                    totalBet: 1864380.72,
                    numFirstDeposit: 398,
                    firstDepositAmount: 652940
                },
                "Tier 1": {
                    depositNumber: 197,
                    depositAmount: 286440,
                    numBettors: 189,
                    totalBet: 885240.53,
                    numFirstDeposit: 182,
                    firstDepositAmount: 236855
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 7000, betAmount: 13965.52, commission: 64.95, time: "2025-05-10" },
                    { uid: "379529", level: 1, depositAmount: 2200, betAmount: 4829.29, commission: 38.26, time: "2025-05-10" },
                    { uid: "371693", level: 1, depositAmount: 14900, betAmount: 24936.52, commission: 62.65, time: "2025-05-10" },
                    { uid: "379351", level: 1, depositAmount: 950, betAmount: 1657.54, commission: 15.64, time: "2025-05-10" },
                    { uid: "374529", level: 1, depositAmount: 5600, betAmount: 9730.34, commission: 36.74, time: "2025-05-10" },
                    { uid: "374193", level: 2, depositAmount: 1700, betAmount: 2864.51, commission: 22.17, time: "2025-05-10" },
                    { uid: "375942", level: 2, depositAmount: 780, betAmount: 1386, commission: 14.85, time: "2025-05-10" },
                    { uid: "369361", level: 2, depositAmount: 1150, betAmount: 2394.52, commission: 26.43, time: "2025-05-10" }
                ]
            },
            "2025-05-09": {
                "All": {
                    depositNumber: 548,
                    depositAmount: 969140,
                    numBettors: 522,
                    totalBet: 3296440.38,
                    numFirstDeposit: 518,
                    firstDepositAmount: 852294
                },
                "Tier 1": {
                    depositNumber: 145,
                    depositAmount: 329740,
                    numBettors: 128,
                    totalBet: 753940.42,
                    numFirstDeposit: 123,
                    firstDepositAmount: 253205
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 1000, betAmount: 2593, commission: 19.37, time: "2025-05-09" },
                    { uid: "379529", level: 1, depositAmount: 2000, betAmount: 4982, commission: 34.19, time: "2025-05-09" },
                    { uid: "371693", level: 1, depositAmount: 15000, betAmount: 19640, commission: 102.48, time: "2025-05-09" },
                    { uid: "379351", level: 1, depositAmount: 450, betAmount: 936, commission: 11.46, time: "2025-05-09" },
                    { uid: "374529", level: 1, depositAmount: 1963, betAmount: 3945, commission: 52.91, time: "2025-05-09" },
                    { uid: "374193", level: 2, depositAmount: 1490, betAmount: 3764, commission: 41.28, time: "2025-05-09" },
                    { uid: "375942", level: 2, depositAmount: 650, betAmount: 1497, commission: 32.94, time: "2025-05-09" },
                    { uid: "369361", level: 2, depositAmount: 1200, betAmount: 2483.75, commission: 25.84, time: "2025-05-09" }
                ]
            },
            "2025-05-08": {
                "All": {
                    depositNumber: 451,
                    depositAmount: 862405,
                    numBettors: 432,
                    totalBet: 2194460.27,
                    numFirstDeposit: 434,
                    firstDepositAmount: 752150
                },
                "Tier 1": {
                    depositNumber: 121,
                    depositAmount: 223201,
                    numBettors: 109,
                    totalBet: 429740.28,
                    numFirstDeposit: 116,
                    firstDepositAmount: 196306
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 820, betAmount: 1530, commission: 11.29, time: "2025-05-08" },
                    { uid: "379529", level: 1, depositAmount: 46200, betAmount: 78400, commission: 127.49, time: "2025-05-08" },
                    { uid: "371693", level: 1, depositAmount: 11000, betAmount: 17369, commission: 71.93, time: "2025-05-08" },
                    { uid: "379351", level: 1, depositAmount: 2710, betAmount: 3298, commission: 13.29, time: "2025-05-08" },
                    { uid: "374529", level: 1, depositAmount: 75000, betAmount: 10490, commission: 51.94, time: "2025-05-08" },
                    { uid: "374193", level: 2, depositAmount: 655, betAmount: 1168, commission: 13.29, time: "2025-05-08" },
                    { uid: "375942", level: 2, depositAmount: 743, betAmount: 1237, commission: 15.72, time: "2025-05-08" },
                    { uid: "369361", level: 2, depositAmount: 850, betAmount: 2183, commission: 21.15, time: "2025-05-08" }
                ]
            },
            "2025-05-07": {
                "All": {
                    depositNumber: 326,
                    depositAmount: 540370,
                    numBettors: 312,
                    totalBet: 1745770.32,
                    numFirstDeposit: 317,
                    firstDepositAmount: 465070
                },
                "Tier 1": {
                    depositNumber: 102,
                    depositAmount: 154550,
                    numBettors: 101,
                    totalBet: 369740.94,
                    numFirstDeposit: 100,
                    firstDepositAmount: 129408
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 8520, betAmount: 14560, commission: 27.83, time: "2025-05-07" },
                    { uid: "379529", level: 1, depositAmount: 56000, betAmount: 95320, commission: 142.78, time: "2025-05-07" },
                    { uid: "371693", level: 1, depositAmount: 12000, betAmount: 16400, commission: 41.26, time: "2025-05-07" },
                    { uid: "379351", level: 1, depositAmount: 2000, betAmount: 3290, commission: 19.47, time: "2025-05-07" },
                    { uid: "374529", level: 1, depositAmount: 5500, betAmount: 12490, commission: 35.19, time: "2025-05-07" },
                    { uid: "374193", level: 2, depositAmount: 640, betAmount: 1289, commission: 9.83, time: "2025-05-07" },
                    { uid: "375942", level: 2, depositAmount: 740, betAmount: 1420, commission: 13.48, time: "2025-05-07" },
                    { uid: "369361", level: 2, depositAmount: 950, betAmount: 2493, commission: 20.18, time: "2025-05-07" }
                ]
            },
            "2025-05-06": {
                "All": {
                    depositNumber: 319,
                    depositAmount: 496200,
                    numBettors: 303,
                    totalBet: 1696340.93,
                    numFirstDeposit: 306,
                    firstDepositAmount: 396250
                },
                "Tier 1": {
                    depositNumber: 134,
                    depositAmount: 278488,
                    numBettors: 128,
                    totalBet: 953310.37,
                    numFirstDeposit: 130,
                    firstDepositAmount: 179740
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 3040, betAmount: 6832, commission: 42.19, time: "2025-05-06" },
                    { uid: "379529", level: 1, depositAmount: 2553, betAmount: 7294, commission: 29.91, time: "2025-05-06" },
                    { uid: "371693", level: 1, depositAmount: 2000, betAmount: 5930, commission: 33.49, time: "2025-05-06" },
                    { uid: "379351", level: 1, depositAmount: 6000, betAmount: 19404, commission: 109.916, time: "2025-05-06" },
                    { uid: "374529", level: 1, depositAmount: 9500, betAmount: 28745, commission: 139.48, time: "2025-05-06" },
                    { uid: "374193", level: 2, depositAmount: 305, betAmount: 632, commission: 12.49, time: "2025-05-06" },
                    { uid: "375942", level: 2, depositAmount: 505, betAmount: 963, commission: 15.49, time: "2025-05-06" },
                    { uid: "369361", level: 2, depositAmount: 757, betAmount: 1739, commission: 20.91, time: "2025-05-06" }
                ]
            },
            "2025-05-05": {
                "All": {
                    depositNumber: 343,
                    depositAmount: 523970,
                    numBettors: 324,
                    totalBet: 1396430.36,
                    numFirstDeposit: 315,
                    firstDepositAmount: 429640
                },
                "Tier 1": {
                    depositNumber: 135,
                    depositAmount: 284220,
                    numBettors: 129,
                    totalBet: 594206,
                    numFirstDeposit: 123,
                    firstDepositAmount: 248280
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 2390, betAmount: 4530, commission: 17.29, time: "2025-05-05" },
                    { uid: "379529", level: 1, depositAmount: 1950, betAmount: 4620, commission: 20.39, time: "2025-05-05" },
                    { uid: "371693", level: 1, depositAmount: 2700, betAmount: 3974, commission: 27.94, time: "2025-05-05" },
                    { uid: "379351", level: 1, depositAmount: 5520, betAmount: 14420, commission: 68.29, time: "2025-05-05" },
                    { uid: "374529", level: 1, depositAmount: 8630, betAmount: 17530, commission: 68.25, time: "2025-05-05" },
                    { uid: "374193", level: 2, depositAmount: 357, betAmount: 993, commission: 16.08, time: "2025-05-05" },
                    { uid: "375942", level: 2, depositAmount: 450, betAmount: 917, commission: 23.59, time: "2025-05-05" },
                    { uid: "369361", level: 2, depositAmount: 630, betAmount: 1295, commission: 46.29, time: "2025-05-05" }
                ]
            },
            "2025-05-04": {
                "All": {
                    depositNumber: 626,
                    depositAmount: 504240,
                    numBettors: 615,
                    totalBet: 1863935.96,
                    numFirstDeposit: 585,
                    firstDepositAmount: 421855
                },
                "Tier 1": {
                    depositNumber: 234,
                    depositAmount: 182590,
                    numBettors: 224,
                    totalBet: 782546.91,
                    numFirstDeposit: 210,
                    firstDepositAmount: 126530
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 8530, betAmount: 14980, commission: 35.19, time: "2025-05-04" },
                    { uid: "379529", level: 1, depositAmount: 23000, betAmount: 31940, commission: 94.39, time: "2025-05-04" },
                    { uid: "371693", level: 1, depositAmount: 6930, betAmount: 14845, commission: 29.91, time: "2025-05-04" },
                    { uid: "379351", level: 1, depositAmount: 38940, betAmount: 85305, commission: 194.29, time: "2025-05-04" },
                    { uid: "374529", level: 1, depositAmount: 10740, betAmount: 23945, commission: 31.94, time: "2025-05-04" },
                    { uid: "374193", level: 2, depositAmount: 1200, betAmount: 1940, commission: 25.46, time: "2025-05-04" },
                    { uid: "375942", level: 2, depositAmount: 300, betAmount: 1063, commission: 21.42, time: "2025-05-04" },
                    { uid: "369361", level: 2, depositAmount: 500, betAmount: 649, commission: 10.29, time: "2025-05-04" }
                ]
            },
            "2025-05-03": {
                "All": {
                    depositNumber: 568,
                    depositAmount: 428610,
                    numBettors: 543,
                    totalBet: 1287310.83,
                    numFirstDeposit: 518,
                    firstDepositAmount: 386520
                },
                "Tier 1": {
                    depositNumber: 207,
                    depositAmount: 158360,
                    numBettors: 201,
                    totalBet: 782510.29,
                    numFirstDeposit: 185,
                    firstDepositAmount: 123853
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 2000, betAmount: 3561, commission: 23.92, time: "2025-05-03" },
                    { uid: "379529", level: 1, depositAmount: 25000, betAmount: 34903, commission: 71.34, time: "2025-05-03" },
                    { uid: "371693", level: 1, depositAmount: 6420, betAmount: 13470, commission: 54.59, time: "2025-05-03" },
                    { uid: "379351", level: 1, depositAmount: 5000, betAmount: 6850, commission: 45.49, time: "2025-05-03" },
                    { uid: "374529", level: 1, depositAmount: 8000, betAmount: 18756, commission: 64.29, time: "2025-05-03" },
                    { uid: "374193", level: 2, depositAmount: 1640, betAmount: 2650, commission: 29.39, time: "2025-05-03" },
                    { uid: "375942", level: 2, depositAmount: 700, betAmount: 1940, commission: 26.59, time: "2025-05-03" },
                    { uid: "369361", level: 2, depositAmount: 1074, betAmount: 1940, commission: 12.94, time: "2025-05-03" }
                ]
            },
            "2025-05-02": {
                "All": {
                    depositNumber: 519,
                    depositAmount: 378520,
                    numBettors: 496,
                    totalBet: 952917.23,
                    numFirstDeposit: 482,
                    firstDepositAmount: 326840
                },
                "Tier 1": {
                    depositNumber: 182,
                    depositAmount: 126385,
                    numBettors: 175,
                    totalBet: 672978.91,
                    numFirstDeposit: 173,
                    firstDepositAmount: 108350
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 5400, betAmount: 13937, commission: 51.36, time: "2025-05-02" },
                    { uid: "379529", level: 1, depositAmount: 63930, betAmount: 194730, commission: 163.49, time: "2025-05-02" },
                    { uid: "371693", level: 1, depositAmount: 6130, betAmount: 14950, commission: 54.19, time: "2025-05-02" },
                    { uid: "379351", level: 1, depositAmount: 4000, betAmount: 5934, commission: 39.56, time: "2025-05-02" },
                    { uid: "374529", level: 1, depositAmount: 16400, betAmount: 29506, commission: 87.49, time: "2025-05-02" },
                    { uid: "374193", level: 2, depositAmount: 1300, betAmount: 2100, commission: 25.48, time: "2025-05-02" },
                    { uid: "375942", level: 2, depositAmount: 750, betAmount: 1390, commission: 13.29, time: "2025-05-02" },
                    { uid: "369361", level: 2, depositAmount: 1280, betAmount: 2394, commission: 16.78, time: "2025-05-02" }
                ]
            },
            "2025-05-01": {
                "All": {
                    depositNumber: 412,
                    depositAmount: 298640,
                    numBettors: 396,
                    totalBet: 946738.917,
                    numFirstDeposit: 385,
                    firstDepositAmount: 253550
                },
                "Tier 1": {
                    depositNumber: 168,
                    depositAmount: 135290,
                    numBettors: 153,
                    totalBet: 853147.54,
                    numFirstDeposit: 150,
                    firstDepositAmount: 112518
                },
                uidCards: [
                    { uid: "3719675", level: 1, depositAmount: 200, betAmount: 492, commission: 9.82, time: "2025-05-01" },
                    { uid: "379529", level: 1, depositAmount: 310, betAmount: 453, commission: 11.39, time: "2025-05-01" },
                    { uid: "371693", level: 1, depositAmount: 2600, betAmount: 9420, commission: 31.26, time: "2025-05-01" },
                    { uid: "379351", level: 1, depositAmount: 9710, betAmount: 13059, commission: 81.34, time: "2025-05-01" },
                    { uid: "374529", level: 1, depositAmount: 15000, betAmount: 24634, commission: 63.19, time: "2025-05-01" },
                    { uid: "374193", level: 2, depositAmount: 2400, betAmount: 3290, commission: 27.38, time: "2025-05-01" },
                    { uid: "375942", level: 2, depositAmount: 800, betAmount: 1940, commission: 23.18, time: "2025-05-01" },
                    { uid: "369361", level: 2, depositAmount: 1300, betAmount: 1684, commission: 23.19, time: "2025-05-01" }
                ]
            },
            "2025-04-30": {
                "All": {
                    depositNumber: 469,
                    depositAmount: 628487,
                    numBettors: 435,
                    totalBet: 1753982.97,
                    numFirstDeposit: 429,
                    firstDepositAmount: 328753
                },
                "Tier 1": {
                    depositNumber: 213,
                    depositAmount: 245370,
                    numBettors: 204,
                    totalBet: 1287485.932,
                    numFirstDeposit: 202,
                    firstDepositAmount: 195284
                }
            },
            "2025-04-29": {
                "All": {
                    depositNumber: 319,
                    depositAmount: 173590,
                    numBettors: 297,
                    totalBet: 853910.75,
                    numFirstDeposit: 295,
                    firstDepositAmount: 148629
                },
                "Tier 1": {
                    depositNumber: 127,
                    depositAmount: 98520,
                    numBettors: 116,
                    totalBet: 291630.92,
                    numFirstDeposit: 108,
                    firstDepositAmount: 85210
                }
            },
            "2025-04-28": {
                "All": {
                    depositNumber: 219,
                    depositAmount: 953500,
                    numBettors: 197,
                    totalBet: 239402.92,
                    numFirstDeposit: 184,
                    firstDepositAmount: 82840
                },
                "Tier 1": {
                    depositNumber: 121,
                    depositAmount: 62904,
                    numBettors: 109,
                    totalBet: 169420.94,
                    numFirstDeposit: 113,
                    firstDepositAmount: 52950
                }
            },
            "2025-04-26": {
                "All": {
                depositNumber: 0,
                depositAmount: 0,
                numBettors: 0,
                totalBet: 0,
                numFirstDeposit: 0,
                firstDepositAmount: 0
            },
                uidCards: []
            }
        };

        function pad(n) { return n.toString().padStart(2, '0'); }

        function fillPickerCol(col, arr, selected) {
            col.innerHTML = '';
            
            // Add empty padding items before
            for (let i = 0; i < 3; i++) {
                const padDiv = document.createElement('div');
                padDiv.className = 'picker-item pad';
                padDiv.innerHTML = '&nbsp;';
                padDiv.style.visibility = 'hidden';
                col.appendChild(padDiv);
            }
            
            arr.forEach(val => {
                const div = document.createElement('div');
                div.className = 'picker-item' + (val == selected ? ' selected' : '');
                div.textContent = val;
                div.dataset.value = val;
                col.appendChild(div);
            });
            
            // Add empty padding items after
            for (let i = 0; i < 3; i++) {
                const padDiv = document.createElement('div');
                padDiv.className = 'picker-item pad';
                padDiv.innerHTML = '&nbsp;';
                padDiv.style.visibility = 'hidden';
                col.appendChild(padDiv);
            }
        }

        function scrollToSelected(col) {
            const sel = col.querySelector('.selected');
            if (sel) {
                col.scrollTop = sel.offsetTop - col.clientHeight/2 + sel.clientHeight/2;
            }
        }

        function updatePickerCols({year=true, month=true, day=true} = {}) {
            const maxDate = new Date(2025, 4, 17); // May 17, 2025
            
            // Only refill columns if needed
            if (year) {
                let years = [];
                for(let y=2022; y<=2025; y++) years.push(y);
                fillPickerCol(yearCol, years, pickerState.year);
            }
            if (month) {
                let months = [];
                for(let m=1; m<=12; m++) {
                    // Skip future months in max year
                    if (pickerState.year === maxDate.getFullYear() && m > maxDate.getMonth() + 1) continue;
                    months.push(pad(m));
                }
                fillPickerCol(monthCol, months, pad(pickerState.month));
            }
            if (day) {
                let daysInMonth = new Date(pickerState.year, pickerState.month, 0).getDate();
                let days = [];
                for(let d=1; d<=daysInMonth; d++) {
                    // Skip future days in max year and month
                    if (pickerState.year === maxDate.getFullYear() && 
                        pickerState.month === maxDate.getMonth() + 1 && 
                        d > maxDate.getDate()) continue;
                    days.push(pad(d));
                }
                fillPickerCol(dayCol, days, pad(pickerState.day));
            }
            setTimeout(() => {
                scrollToSelected(yearCol);
                scrollToSelected(monthCol);
                scrollToSelected(dayCol);
            }, 10);
        }

        function setSelected(col, value) {
            Array.from(col.children).forEach(child => {
                if (!child.classList.contains('pad') && child.dataset.value == value) {
                    child.classList.add('selected');
                } else {
                    child.classList.remove('selected');
                }
            });
        }

        function handlePickerClick(col, key, isDayCol = false) {
            col.addEventListener('click', e => {
                if (e.target.classList.contains('picker-item') && !e.target.classList.contains('pad')) {
                    const newValue = parseInt(e.target.dataset.value);
                    const maxDate = new Date(2025, 4, 17); // May 17, 2025
                    
                    let isValid = true;
                    // Check if selection would exceed max date
                    if (key === 'year' && newValue > maxDate.getFullYear()) {
                        isValid = false;
                    } else if (key === 'month' && 
                              pickerState.year === maxDate.getFullYear() && 
                              newValue > maxDate.getMonth() + 1) {
                        isValid = false;
                    } else if (key === 'day' && 
                              pickerState.year === maxDate.getFullYear() && 
                              pickerState.month === maxDate.getMonth() + 1 && 
                              newValue > maxDate.getDate()) {
                        isValid = false;
                    }
                    
                    if (isValid) {
                        pickerState[key] = newValue;
                    setSelected(col, e.target.dataset.value);
                    if (key === 'year' || key === 'month') {
                        // If year or month changes, update days column
                        updatePickerCols({year:false, month:false, day:true});
                        }
                    }
                }
            });
            col.addEventListener('scroll', () => {
                clearTimeout(col._scrollTimeout);
                col._scrollTimeout = setTimeout(() => {
                    let items = Array.from(col.children).filter(item => !item.classList.contains('pad'));
                    let closest = items.reduce((a, b) => {
                        return Math.abs(a.offsetTop - col.scrollTop - col.clientHeight/2 + a.clientHeight/2) <
                               Math.abs(b.offsetTop - col.scrollTop - col.clientHeight/2 + b.clientHeight/2) ? a : b;
                    });
                    
                    const newValue = parseInt(closest.dataset.value);
                    const maxDate = new Date(2025, 4, 17); // May 17, 2025
                    
                    let isValid = true;
                    // Check if scroll would exceed max date
                    if (key === 'year' && newValue > maxDate.getFullYear()) {
                        isValid = false;
                    } else if (key === 'month' && 
                              pickerState.year === maxDate.getFullYear() && 
                              newValue > maxDate.getMonth() + 1) {
                        isValid = false;
                    } else if (key === 'day' && 
                              pickerState.year === maxDate.getFullYear() && 
                              pickerState.month === maxDate.getMonth() + 1 && 
                              newValue > maxDate.getDate()) {
                        isValid = false;
                    }
                    
                    if (isValid) {
                        pickerState[key] = newValue;
                    setSelected(col, closest.dataset.value);
                    if ((key === 'year' || key === 'month') && isDayCol) {
                        updatePickerCols({year:false, month:false, day:true});
                        }
                    }
                }, 100);
            });
        }

        handlePickerClick(yearCol, 'year');
        handlePickerClick(monthCol, 'month');
        handlePickerClick(dayCol, 'day', true);

        openDateModal.onclick = function() {
            // Set pickerState to current date
            const [y, m, d] = selectedDateSpan.textContent.split('-');
            pickerState.year = parseInt(y);
            pickerState.month = parseInt(m);
            pickerState.day = parseInt(d);
            updatePickerCols();
            dateModalOverlay.classList.add('active');
        };
        cancelDate.onclick = function() {
            dateModalOverlay.classList.remove('active');
        };
        let lastStats = {
            depositNumber: 0,
            depositAmount: 0,
            numBettors: 0,
            totalBet: 0,
            numFirstDeposit: 0,
            firstDepositAmount: 0
        };

        function updateStatsBox(data) {
            // If data is coming directly from statsData, it will have tier structure
            const tierData = data[selectedTier] || {
                depositNumber: 0,
                depositAmount: 0,
                numBettors: 0,
                totalBet: 0,
                numFirstDeposit: 0,
                firstDepositAmount: 0
            };
            
            document.getElementById('depositNumber').textContent = tierData.depositNumber;
            document.getElementById('depositAmount').textContent = tierData.depositAmount;
            document.getElementById('numBettors').textContent = tierData.numBettors;
            document.getElementById('totalBet').textContent = tierData.totalBet;
            document.getElementById('numFirstDeposit').textContent = tierData.numFirstDeposit;
            document.getElementById('firstDepositAmount').textContent = tierData.firstDepositAmount;
            
            // UID cards are at the date level, not the tier level
            updateUIDCards(data.uidCards || []);
        }

        function updateUIDCards(uidCards) {
            const uidCardsContainer = document.getElementById('uidCards');
            uidCardsContainer.innerHTML = '';
            
            if (uidCards && uidCards.length > 0) {
                uidCards.forEach(card => {
                    const cardHTML = `
                        <div style="background: white; margin: 15px; padding: 15px; border-radius: 8px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span style="font-weight: 500;">UID:${card.uid}</span>
                                    <img src="icons/copy-icon.png" alt="Copy" style="width: 16px; height: 16px; opacity: 0.6; cursor: pointer;" 
                                        onclick="copyToClipboard('${card.uid}')">
                                </div>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="color: #666;">Level</span>
                                <span>${card.level}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="color: #666;">Deposit amount</span>
                                <span style="color: #ffcb2d;">${card.depositAmount}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="color: #666;">Bet amount</span>
                                <span style="color: #ffcb2d;">${card.betAmount}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="color: #666;">Commission</span>
                                <span style="color: #ffcb2d;">${card.commission}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: #666;">Time</span>
                                <span style="color: #999; font-size: 11px;">${card.time}</span>
                            </div>
                        </div>
                    `;
                    uidCardsContainer.innerHTML += cardHTML;
                });
            }
        }

        // Add this function for copy functionality
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                // Optional: Show a brief feedback message
                alert('UID copied to clipboard');
            }).catch(err => {
                console.error('Failed to copy:', err);
            });
        }

        confirmDate.onclick = function() {
            const y = pickerState.year, m = pad(pickerState.month), d = pad(pickerState.day);
            const dateStr = `${y}-${m}-${d}`;
            selectedDateSpan.textContent = dateStr;
            dateModalOverlay.classList.remove('active');

            // Show loading spinner
            const spinner = document.getElementById('loadingSpinner');
            spinner.style.display = 'block';

            // Keep previous data for 0.3s, then update (increased by 0.2s)
            setTimeout(() => {
                const data = statsData[dateStr] || {
                    "All": {
                    depositNumber: 0,
                    depositAmount: 0,
                    numBettors: 0,
                    totalBet: 0,
                    numFirstDeposit: 0,
                    firstDepositAmount: 0
                    },
                    uidCards: []
                };
                updateStatsBox(data);
                spinner.style.display = 'none';
                document.getElementById('noData').style.display = 'none';
                if (!statsData[dateStr]) {
                document.getElementById('noData').style.display = '';
                }
            }, 300);
        };

        // --- Tier Modal Logic (visual only, scrollable) ---
        const openTierModal = document.getElementById('openTierModal');
        const tierModalOverlay = document.getElementById('tierModalOverlay');
        const cancelTier = document.getElementById('cancelTier');
        const confirmTier = document.getElementById('confirmTier');
        const selectedTierSpan = document.getElementById('selectedTier');
        const tierCol = document.getElementById('tierCol');
        let selectedTier = "All";
        let tempSelectedTier = "All";
        const tierList = ["All", "Tier 1", "Tier 2", "Tier 3", "Tier 4", "Tier 5", "Tier 6"];

        function fillTierCol(selected) {
            tierCol.innerHTML = '';
            
            // Add padding items before
            for (let i = 0; i < 3; i++) {
                const padDiv = document.createElement('div');
                padDiv.className = 'tier-option pad';
                padDiv.innerHTML = '&nbsp;';
                padDiv.style.visibility = 'hidden';
                tierCol.appendChild(padDiv);
            }
            
            tierList.forEach(tier => {
                const div = document.createElement('div');
                div.className = 'tier-option' + (tier === selected ? ' selected' : '');
                div.textContent = tier;
                div.dataset.tier = tier;
                tierCol.appendChild(div);
            });
            
            // Add padding items after
            for (let i = 0; i < 3; i++) {
                const padDiv = document.createElement('div');
                padDiv.className = 'tier-option pad';
                padDiv.innerHTML = '&nbsp;';
                padDiv.style.visibility = 'hidden';
                tierCol.appendChild(padDiv);
            }
        }

        function scrollToSelectedTier() {
            const sel = tierCol.querySelector('.selected');
            if (sel) {
                tierCol.scrollTop = sel.offsetTop - tierCol.clientHeight/2 + sel.clientHeight/2;
            }
        }

        openTierModal.onclick = function(e) {
            tempSelectedTier = selectedTier;
            fillTierCol(selectedTier);
            setTimeout(scrollToSelectedTier, 10);
            tierModalOverlay.classList.add('active');
        };

        cancelTier.onclick = function() {
            tierModalOverlay.classList.remove('active');
        };

        confirmTier.onclick = function() {
            selectedTier = tempSelectedTier;
            selectedTierSpan.textContent = selectedTier;
            tierModalOverlay.classList.remove('active');

            const spinner = document.getElementById('loadingSpinner');
            spinner.style.display = 'block';

            // Get current date from the date span
            const currentDate = selectedDateSpan.textContent;

            setTimeout(() => {
                const data = statsData[currentDate] || {
                    "All": {
                        depositNumber: 0,
                        depositAmount: 0,
                        numBettors: 0,
                        totalBet: 0,
                        numFirstDeposit: 0,
                        firstDepositAmount: 0
                    },
                    uidCards: []
                };
                
                updateStatsBox(data);
                spinner.style.display = 'none';
            }, 300);
        };

        // Delegate click and scroll for tierCol
        tierCol.onclick = function(e) {
            if (e.target.classList.contains('tier-option') && !e.target.classList.contains('pad')) {
                Array.from(tierCol.children).forEach(o => {
                    o.classList.remove('selected');
                    o.style.color = "#b0b0b0";
                    o.style.fontWeight = "normal";
                });
                e.target.classList.add('selected');
                e.target.style.color = "#222";
                e.target.style.fontWeight = "bold";
                tempSelectedTier = e.target.dataset.tier;
            }
        };
        tierCol.addEventListener('scroll', () => {
            clearTimeout(tierCol._scrollTimeout);
            tierCol._scrollTimeout = setTimeout(() => {
                let items = Array.from(tierCol.children).filter(item => !item.classList.contains('pad'));
                let closest = items.reduce((a, b) => {
                    return Math.abs(a.offsetTop - tierCol.scrollTop - tierCol.clientHeight/2 + a.clientHeight/2) <
                           Math.abs(b.offsetTop - tierCol.scrollTop - tierCol.clientHeight/2 + b.clientHeight/2) ? a : b;
                });
                Array.from(tierCol.children).forEach(o => {
                    o.classList.remove('selected');
                    o.style.color = "#b0b0b0";
                    o.style.fontWeight = "normal";
                });
                closest.classList.add('selected');
                closest.style.color = "#222";
                closest.style.fontWeight = "bold";
                tempSelectedTier = closest.dataset.tier;
            }, 100);
        });

        window.addEventListener('DOMContentLoaded', () => {
            // Get the initial date from the selectedDateSpan
            const initialDate = selectedDateSpan.textContent;
            
            // Get the data for the initial date
            const initialData = statsData[initialDate] || {
                "All": {
                    depositNumber: 0,
                    depositAmount: 0,
                    numBettors: 0,
                    totalBet: 0,
                    numFirstDeposit: 0,
                    firstDepositAmount: 0
                },
                uidCards: []
            };
            
            // Update both the stats box and UID cards
            updateStatsBox(initialData);
            updateUIDCards(initialData.uidCards || []);
        });

        // Add this after your existing script
        function isDateValid(year, month, day) {
            const selectedDate = new Date(year, month - 1, day);
            const maxDate = new Date(2025, 4, 17); // May 17, 2025 (months are 0-based)
            
            return selectedDate <= maxDate;
        }

        // Modify your date picker's click/change handlers
        const dateSelectors = document.querySelectorAll('.date-selector');
        dateSelectors.forEach(selector => {
            selector.addEventListener('change', function(e) {
                const year = parseInt(document.querySelector('[name="year"]').value);
                const month = parseInt(document.querySelector('[name="month"]').value);
                const day = parseInt(document.querySelector('[name="day"]').value);

                if (!isDateValid(year, month, day)) {
                    alert('Cannot select future dates');
                    // Reset to today's date
                    document.querySelector('[name="year"]').value = '2025';
                    document.querySelector('[name="month"]').value = '5';
                    document.querySelector('[name="day"]').value = '17';
                    e.preventDefault();
                    return false;
                }
            });
        });

        // Additionally, set max values for the date inputs
        document.querySelector('[name="year"]').max = '2025';
        document.querySelector('[name="month"]').max = '5';
        document.querySelector('[name="day"]').max = '17';
    </script>
</body>
</html>
